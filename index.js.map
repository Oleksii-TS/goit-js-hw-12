{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '50286619-c20e9afd7f4c04ec0a12478f1';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport async function getImagesByQuery(query, page = 1, per_page = 15) {\n  const params = {\n    key: API_KEY,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page,\n    per_page,\n  };\n  try {\n    const response = await axios.get(BASE_URL, { params });\n    return response.data;\n  } catch (error) {\n    console.error('Error fetching images:', error);\n    throw error;\n  }\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst galleryContainer = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\n\nlet lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nexport function createGallery(images) {\n  const markup = images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        const keywords = tags.split(',').slice(0, 5).join(', ');\n\n        return `\n      <li class=\"gallery-item\">\n        <a href=\"${largeImageURL}\" data-lightbox=\"gallery\">\n          <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${keywords}\" loading=\"lazy\" />\n        </a>\n        <div class=\"info\">\n          <div class=\"image-info\">\n            <div class=\"info-item\">\n              <p class=\"info-title\"><b>Likes:</b></p>\n              <p class=\"info-value\">${likes}</p>\n            </div>\n            <div class=\"info-item\">\n              <p class=\"info-title\"><b>Views:</b></p>\n              <p class=\"info-value\">${views}</p>\n            </div>\n            <div class=\"info-item\">\n              <p class=\"info-title\"><b>Comments:</b></p>\n              <p class=\"info-value\">${comments}</p>\n            </div>\n            <div class=\"info-item\">\n              <p class=\"info-title\"><b>Downloads:</b></p>\n              <p class=\"info-value\">${downloads}</p>\n            </div>\n          </div>\n        </div>\n      </li>`;\n      }\n    )\n    .join('');\n\n  galleryContainer.insertAdjacentHTML('beforeend', markup);\n  lightbox.refresh();\n}\n\nexport function showLoader() {\n  document.getElementById('loader').hidden = false;\n}\n\nexport function hideLoader() {\n  document.getElementById('loader').hidden = true;\n}\n\nexport function clearGallery() {\n  galleryContainer.innerHTML = '';\n}\n","import { getImagesByQuery } from './js/pixabay-api.js';\nimport {\n  createGallery,\n  clearGallery,\n  showLoader,\n  hideLoader,\n} from './js/render-functions.js';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport Pagination from 'tui-pagination';\nimport 'tui-pagination/dist/tui-pagination.min.css';\n\nconst paginationContainer = document.getElementById('pagination');\nlet pagination = null;\nconst perPage = 15;\n\nconst form = document.querySelector('.form');\nconst input = form.querySelector(\"input[name='search-text']\");\nconst loadMoreBtn = document.querySelector('.load-more-btn');\n\nlet currentPage = 1;\nlet currentQuery = '';\nlet totalHits = 0;\n\nform.addEventListener('submit', async e => {\n  e.preventDefault();\n  const query = input.value.trim();\n\n  if (!query) {\n    iziToast.warning({\n      message: 'Please enter a search query.',\n      position: 'topRight',\n    });\n    return;\n  }\n\n  currentQuery = query;\n  currentPage = 1;\n  clearGallery();\n  loadMoreBtn.hidden = true;\n\n  if (pagination) {\n    paginationContainer.innerHTML = '';\n    pagination = null;\n  }\n\n  try {\n    showLoader();\n    const data = await getImagesByQuery(currentQuery, currentPage);\n\n    totalHits = data.totalHits;\n\n    if (data.hits.length === 0) {\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n      });\n      loadMoreBtn.hidden = true;\n      return;\n    }\n\n    createGallery(data.hits);\n\n    if (currentPage * perPage < totalHits) {\n      loadMoreBtn.hidden = false;\n    } else {\n      loadMoreBtn.hidden = true;\n    }\n\n    pagination = new Pagination(paginationContainer, {\n      totalItems: totalHits,\n      itemsPerPage: perPage,\n      visiblePages: 5,\n      page: currentPage,\n      centerAlign: true,\n    });\n\n    pagination.on('afterMove', async event => {\n      const page = event.page;\n      if (page !== currentPage) {\n        currentPage = page;\n        loadMoreBtn.hidden = true;\n        showLoader();\n\n        try {\n          const data = await getImagesByQuery(currentQuery, currentPage);\n\n          clearGallery();\n          createGallery(data.hits);\n\n          if (currentPage * perPage < totalHits) {\n            loadMoreBtn.hidden = false;\n          } else {\n            loadMoreBtn.hidden = true;\n            iziToast.info({\n              message:\n                \"We're sorry, but you've reached the end of search results.\",\n              position: 'topRight',\n            });\n          }\n\n          const galleryItems = document.querySelectorAll(\n            '.gallery .gallery-item'\n          );\n          if (galleryItems.length > 0) {\n            const { height: cardHeight } =\n              galleryItems[0].getBoundingClientRect();\n            window.scrollBy({\n              top: cardHeight * 2,\n              behavior: 'smooth',\n            });\n          }\n        } catch (error) {\n          iziToast.error({\n            message: `Error: ${error.message}`,\n            position: 'topRight',\n          });\n        } finally {\n          hideLoader();\n        }\n      }\n    });\n  } catch (error) {\n    iziToast.error({\n      message: `Error: ${error.message}`,\n      position: 'topRight',\n    });\n  } finally {\n    hideLoader();\n  }\n});\n\nloadMoreBtn.addEventListener('click', async () => {\n  currentPage += 1;\n  loadMoreBtn.hidden = true;\n  showLoader();\n\n  try {\n    const data = await getImagesByQuery(currentQuery, currentPage);\n\n    createGallery(data.hits);\n\n    const galleryItems = document.querySelectorAll('.gallery .gallery-item');\n    if (galleryItems.length > 0) {\n      const { height: cardHeight } = galleryItems[0].getBoundingClientRect();\n      window.scrollBy({\n        top: cardHeight * 2,\n        behavior: 'smooth',\n      });\n    }\n\n    if (currentPage * perPage >= totalHits) {\n      loadMoreBtn.hidden = true;\n      iziToast.info({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n    } else {\n      loadMoreBtn.hidden = false;\n    }\n\n    if (pagination) {\n      pagination.movePageTo(currentPage);\n    }\n  } catch (error) {\n    iziToast.error({\n      message: `Error: ${error.message}`,\n      position: 'topRight',\n    });\n  } finally {\n    hideLoader();\n  }\n});\n"],"names":["API_KEY","BASE_URL","getImagesByQuery","query","page","per_page","params","axios","error","galleryContainer","lightbox","SimpleLightbox","createGallery","images","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","keywords","showLoader","hideLoader","clearGallery","paginationContainer","pagination","perPage","form","input","loadMoreBtn","currentPage","currentQuery","totalHits","e","iziToast","data","Pagination","event","galleryItems","cardHeight"],"mappings":"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"}